[![License](https://img.shields.io/badge/License-MIT-9cf.svg)](https://choosealicense.com/licenses/mit/)
[![Test](https://img.shields.io/github/actions/workflow/status/akikuno/dajin2/pytest.yml?branch=main&label=Test&color=brightgreen)](https://github.com/akikuno/dajin2/actions)
[![Python](https://img.shields.io/pypi/pyversions/DAJIN2.svg?label=Python&color=blue)](https://pypi.org/project/DAJIN2/)
[![PyPI](https://img.shields.io/pypi/v/DAJIN2.svg?label=PyPI&color=orange)](https://pypi.org/project/DAJIN2/)
[![Bioconda](https://img.shields.io/conda/v/bioconda/dajin2?label=Bioconda&color=orange)](https://anaconda.org/bioconda/dajin2)
[![DOI](https://zenodo.org/badge/387721337.svg)](https://zenodo.org/badge/latestdoi/387721337)
[![Paper](https://img.shields.io/badge/Plos%20Biol-10.1371/journal.pbio.3001507-lightgreen)](https://journals.plos.org/plosbiology/article?id=10.1371/journal.pbio.3001507)
[![ãŠå•ã„åˆã‚ã›](https://img.shields.io/badge/ãŠå•ã„åˆã‚ã›-923DE2)](https://forms.gle/r4YRs1th7NGHfDcS9)


<p align="center">
<img src="https://user-images.githubusercontent.com/15861316/261833016-7f356960-88cf-4574-87e2-36162b174340.png" width="90%">
</p>

DAJIN2ã¯ã€ãƒŠãƒãƒã‚¢ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ³ã‚°ã‚’ç”¨ã„ãŸã€ã‚²ãƒãƒ ç·¨é›†ã‚µãƒ³ãƒ—ãƒ«ã®éºä¼å‹è§£æãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

**DAJIN**ã®åç§°ã¯ã€Œä¸€ç¶²**æ‰“å°½**ã€ã«ç”±æ¥ã—ã¦ãŠã‚Šã€æ„å›³ã•ã‚ŒãŸå¤‰ç•°ã ã‘ã§ãªãã€æ„å›³ã—ãªã„å¤‰ç•°ã‚‚å«ã‚ã¦ã€**ã‚²ãƒãƒ ç·¨é›†ã®çµæœã‚’ä¸€æ‹¬ã‹ã¤ç¶²ç¾…çš„ã«æ¤œå‡ºã™ã‚‹**ã¨ã„ã†æœ¬ãƒ„ãƒ¼ãƒ«ã®è¨­è¨ˆæ€æƒ³ãŒè¾¼ã‚ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚


# ğŸŒŸ ç‰¹å¾´

+ **ç¶²ç¾…çš„ãªå¤‰ç•°æ¤œå‡º**  
  ãƒŠãƒãƒã‚¢ã«ã‚ˆã‚‹ã‚¿ãƒ¼ã‚²ãƒƒãƒˆé ˜åŸŸã®è§£æã‚’é€šã˜ã¦ã€ç‚¹å¤‰ç•°ã‹ã‚‰æ§‹é€ å¤šå‹ã¾ã§ã€ã‚ã‚‰ã‚†ã‚‹ã‚²ãƒãƒ ç·¨é›†ã‚¤ãƒ™ãƒ³ãƒˆã‚’æ¤œå‡ºå¯èƒ½ã§ã™ã€‚  
  ç‰¹ã«ã€**æƒ³å®šå¤–ã®å¤‰ç•°**ã‚„ã€**æ¬ å¤±é ˜åŸŸã«ãŠã‘ã‚‹æŒ¿å…¥**ãªã©ã€è¤‡åˆçš„ãªå¤‰ç•°ã®æ¤œå‡ºã«å„ªã‚Œã¦ã„ã¾ã™ã€‚

+ **é«˜æ„Ÿåº¦ãªã‚¢ãƒ¬ãƒ«åˆ†é¡**  
  ãƒ¢ã‚¶ã‚¤ã‚¯ã‚¢ãƒ¬ãƒ«ã®åˆ†é¡ã«å¯¾å¿œã—ã¦ãŠã‚Šã€ç´„1%ã®ãƒã‚¤ãƒŠãƒ¼ã‚¢ãƒ¬ãƒ«ã‚‚æ¤œå‡ºå¯èƒ½ã§ã™ã€‚

+ **ç›´æ„Ÿçš„ãªå¯è¦–åŒ–**  
  ã‚²ãƒãƒ ç·¨é›†ã®çµæœã‚’è¦–è¦šçš„ã«è¡¨ç¤ºã—ã€å¤‰ç•°ã®è¿…é€Ÿã‹ã¤å®¹æ˜“ãªè­˜åˆ¥ã‚’æ”¯æ´ã—ã¾ã™ã€‚

+ **å¤šã‚µãƒ³ãƒ—ãƒ«å¯¾å¿œ**  
  è¤‡æ•°ã‚µãƒ³ãƒ—ãƒ«ã®ä¸€æ‹¬å‡¦ç†ã«å¯¾å¿œã—ã¦ãŠã‚Šã€å¤§è¦æ¨¡ãªå®Ÿé¨“ã‚„æ¯”è¼ƒç ”ç©¶ã‚’åŠ¹ç‡çš„ã«å®Ÿæ–½ã§ãã¾ã™ã€‚

+ **ç°¡å˜ãªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨æ“ä½œ**  
  ç‰¹åˆ¥ãªè¨ˆç®—æ©Ÿç’°å¢ƒã‚’å¿…è¦ã¨ã›ãšã€ä¸€èˆ¬çš„ãªãƒãƒ¼ãƒˆãƒ‘ã‚½ã‚³ãƒ³ã§ã‚‚å‹•ä½œã—ã¾ã™ã€‚  
  Biocondaã‚„PyPIã‹ã‚‰ç°¡å˜ã«å°å…¥ã§ãã€ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‹ã‚‰ç›´æ„Ÿçš„ã«åˆ©ç”¨å¯èƒ½ã§ã™ã€‚  


# ğŸ›  ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

## ç’°å¢ƒ

### ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢

- **ä¸€èˆ¬çš„ãªãƒãƒ¼ãƒˆãƒ‘ã‚½ã‚³ãƒ³ã§å‹•ä½œå¯èƒ½**
- ãƒ¡ãƒ¢ãƒªæ¨å¥¨ï¼š8GBä»¥ä¸Š

>[!NOTE]
> å‰èº«ã®DAJINã¯æ·±å±¤å­¦ç¿’ã‚’ä½¿ç”¨ã—ã¦ã„ãŸãŸã‚ã€åŠ¹ç‡çš„ãªè¨ˆç®—ã«ã¯GPUãŒå¿…è¦ã§ã—ãŸã€‚  
> ä¸€æ–¹ã€**DAJIN2ã§ã¯æ·±å±¤å­¦ç¿’ã‚’ç”¨ã„ã¦ãŠã‚‰ãšã€GPUã¯ä¸è¦**ã§ã™ã€‚  
> ãã®ãŸã‚ã€ä¸€èˆ¬çš„ãªãƒãƒ¼ãƒˆãƒ‘ã‚½ã‚³ãƒ³ã§ã‚‚å•é¡Œãªãå‹•ä½œã—ã¾ã™ã€‚

### ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢

- Python >= 3.9
- Unixç’°å¢ƒ (Linux, macOS, WSL2, etc.)

>[!IMPORTANT]
> **Windowsãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ–¹ã¸**  
> DAJIN2ã¯Linuxç’°å¢ƒã§ã®å®Ÿè¡Œã‚’å‰æã¨ã—ã¦ã„ã¾ã™ã€‚Windowsã‚’ã”åˆ©ç”¨ã®å ´åˆã¯ã€  
> **WSL2ï¼ˆWindows Subsystem for Linux 2ï¼‰** ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚

## [Bioconda](https://anaconda.org/bioconda/DAJIN2) ï¼ˆæ¨å¥¨ï¼‰

```bash
# Setup of Bioconda
conda config --add channels defaults
conda config --add channels bioconda
conda config --add channels conda-forge
conda config --set channel_priority flexible

# Install DAJIN2
conda create -n env-dajin2 python=3.12 DAJIN2 -y
conda activate env-dajin2
```

## [PyPI](https://pypi.org/project/DAJIN2/)

```bash
pip install DAJIN2
```

> [!IMPORTANT]
> **DAJIN2ã¯æ´»ç™ºã«é–‹ç™ºãƒ»æ”¹è‰¯ãŒé€²ã‚ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚**  
> æœ€æ–°æ©Ÿèƒ½ã‚’ã”åˆ©ç”¨ã„ãŸã ããŸã‚ã«ã€ã”ä½¿ç”¨ä¸­ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒæœ€æ–°ç‰ˆã§ã‚ã‚‹ã“ã¨ã‚’ã”ç¢ºèªãã ã•ã„ã€‚  
>
> ğŸ” **ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ç¢ºèªæ–¹æ³•ï¼š**
> ```bash
> DAJIN2 --version
> ```
>
> ğŸ†• **æœ€æ–°ç‰ˆã®ç¢ºèªã¯ã“ã¡ã‚‰ï¼š**  
> https://github.com/akikuno/DAJIN2/releases
>
> ğŸ”„ **æœ€æ–°ç‰ˆã¸ã®ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆæ–¹æ³•ï¼š**
> ```bash
> conda update DAJIN2 -y
> ```
> ã¾ãŸã¯
> ```bash
> pip install -U DAJIN2
> ```


> [!CAUTION]
> ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã«å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆã¯ã€[ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰](https://github.com/akikuno/DAJIN2/blob/main/docs/TROUBLESHOOTING.md)ã‚’ã”è¦§ãã ã•ã„ã€‚



# ğŸ’» ä½¿ç”¨æ–¹æ³•

## å¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«

### ã‚µãƒ³ãƒ—ãƒ«ãŠã‚ˆã³ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«

DAJIN2ã§ã¯ã€ã‚²ãƒãƒ ç·¨é›†ç‰¹ç•°çš„ãªå¤‰ç•°ã‚’æ¤œå‡ºã™ã‚‹ãŸã‚ã«ã€**ã‚²ãƒãƒ ç·¨é›†ã‚’å—ã‘ã¦ã„ãªã„ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚µãƒ³ãƒ—ãƒ«**ãŒå¿…è¦ã§ã™ã€‚  
ã‚²ãƒãƒ ç·¨é›†ã‚µãƒ³ãƒ—ãƒ«ã¨ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã®FASTQ/FASTAï¼ˆgzipåœ§ç¸®ãƒ»éåœ§ç¸®ã©ã¡ã‚‰ã‚‚å¯¾å¿œå¯èƒ½ï¼‰ã€ã¾ãŸã¯BAMãƒ•ã‚¡ã‚¤ãƒ«ã‚’å«ã‚€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡å®šã—ã¾ã™ã€‚

#### [Guppy](https://community.nanoporetech.com/docs/prepare/library_prep_protocols/Guppy-protocol/v/gpb_2003_v1_revax_14dec2018/guppy-software-overview)ã«ã‚ˆã‚‹ãƒ™ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ«

Guppyã«ã‚ˆã‚‹ãƒ™ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ«å¾Œã€ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆãŒå‡ºåŠ›ã•ã‚Œã¾ã™ï¼š

```text
fastq_pass
â”œâ”€â”€ barcode01
â”‚   â”œâ”€â”€ fastq_runid_b347657c88dced2d15bf90ee6a1112a3ae91c1af_0_0.fastq.gz
â”‚   â”œâ”€â”€ fastq_runid_b347657c88dced2d15bf90ee6a1112a3ae91c1af_10_0.fastq.gz
â”‚   â””â”€â”€ fastq_runid_b347657c88dced2d15bf90ee6a1112a3ae91c1af_11_0.fastq.gz
â””â”€â”€ barcode02
    â”œâ”€â”€ fastq_runid_b347657c88dced2d15bf90ee6a1112a3ae91c1af_0_0.fastq.gz
    â”œâ”€â”€ fastq_runid_b347657c88dced2d15bf90ee6a1112a3ae91c1af_10_0.fastq.gz
    â””â”€â”€ fastq_runid_b347657c88dced2d15bf90ee6a1112a3ae91c1af_11_0.fastq.gz
```

ä¸Šè¨˜ã®barcode01ã‚’ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã€barcode02ã‚’ã‚µãƒ³ãƒ—ãƒ«ã¨ã™ã‚‹ã¨ã€ãã‚Œãã‚Œã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯ä¸‹è¨˜ã®é€šã‚Šã«æŒ‡å®šã—ã¾ã™ï¼š

+ ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«: `fastq_pass/barcode01`
+ ã‚µãƒ³ãƒ—ãƒ«: `fastq_pass/barcode02`

#### [Dorado](https://github.com/nanoporetech/dorado)ã«ã‚ˆã‚‹ãƒ™ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ«

Doradoã«ã‚ˆã‚‹ãƒ™ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ«ï¼ˆ[`dorado demux`](https://github.com/nanoporetech/dorado?tab=readme-ov-file#barcode-classification)ï¼‰ã«ãŠã„ã¦ã¯ã€BAMãƒ•ã‚¡ã‚¤ãƒ«ãŒå‡ºåŠ›ã•ã‚Œã¾ã™ï¼š

```text
dorado_demultiplex
â”œâ”€â”€ EXP-PBC096_barcode01.bam
â””â”€â”€ EXP-PBC096_barcode02.bam
```

> [!IMPORTANT]
> å„bamãƒ•ã‚¡ã‚¤ãƒ«ã‚’åˆ¥ã€…ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«æ ¼ç´ã—ã¦ãã ã•ã„ã€‚ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã¯ä»»æ„ã§ã™ã€‚

```text
dorado_demultiplex
â”œâ”€â”€ barcode01
â”‚   â””â”€â”€ EXP-PBC096_barcode01.bam
â””â”€â”€ barcode02
    â””â”€â”€ EXP-PBC096_barcode02.bam
```

[`dorado correct`](https://github.com/nanoporetech/dorado)ã«ã‚ˆã‚‹ã‚·ãƒ¼ã‚¯ã‚¨ãƒ³ã‚¹ã‚¨ãƒ©ãƒ¼è£œæ­£å¾Œã«å‡ºåŠ›ã•ã‚Œã‚‹FASTAãƒ•ã‚¡ã‚¤ãƒ«ã‚‚åŒæ§˜ã«ã€åˆ¥ã€…ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«æ ¼ç´ã—ã¦ãã ã•ã„ã€‚

```text
dorado_correct
â”œâ”€â”€ barcode01
â”‚   â””â”€â”€ EXP-PBC096_barcode01.fasta
â””â”€â”€ barcode02
    â””â”€â”€ EXP-PBC096_barcode02.fasta
```

ä¸Šè¨˜ã®barcode01ã‚’ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã€barcode02ã‚’ã‚µãƒ³ãƒ—ãƒ«ã¨ã™ã‚‹ã¨ã€ãã‚Œãã‚Œã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯ä¸‹è¨˜ã®é€šã‚Šã«æŒ‡å®šã—ã¾ã™ï¼š

+ ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«: `dorado_demultiplex/barcode01` / `dorado_correct/barcode01`
+ ã‚µãƒ³ãƒ—ãƒ«: `dorado_demultiplex/barcode02` / `dorado_correct/barcode02`


### æƒ³å®šã‚¢ãƒ¬ãƒ«é…åˆ—ã®FASTAãƒ•ã‚¡ã‚¤ãƒ«

FASTAãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ã€ã‚²ãƒãƒ ç·¨é›†ã«ã‚ˆã£ã¦æƒ³å®šã•ã‚Œã‚‹ã‚¢ãƒ¬ãƒ«ã‚’è¨˜è¿°ã—ã¾ã™ã€‚

> [!IMPORTANT]
>ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚¢ãƒ¬ãƒ«ã®æŒ‡å®šï¼š `>control`ã¨ã„ã†ãƒ˜ãƒƒãƒ€ãƒ¼åã¨ã€ãã®é…åˆ—ã¯å¿…é ˆã§ã™ã€‚  

äº‹å‰ã«æƒ³å®šã•ã‚Œã‚‹ã‚¢ãƒ¬ãƒ«ãŒã‚ã‚‹å ´åˆï¼ˆä¾‹ï¼šãƒãƒƒã‚¯ã‚¤ãƒ³ã‚„ãƒãƒƒã‚¯ã‚¢ã‚¦ãƒˆï¼‰ã€ãã‚Œã‚‰ã®ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚‚FASTAãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜è¼‰ã—ã¦ãã ã•ã„ã€‚ã“ã‚Œã‚‰ã®æƒ³å®šã‚¢ãƒ¬ãƒ«ã®åç§°ã¯ä»»æ„ã«è¨­å®šã§ãã¾ã™ã€‚

ä»¥ä¸‹ã¯ã€FASTAãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸€ä¾‹ã§ã™ï¼š

```text
>control
ACGTACGTACGTACGT
>knock-in
ACGTACGTCCCCACGTACGT
>knock-out
ACGTACGT
```

ã“ã“ã§ã€`>control` ã¯ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚¢ãƒ¬ãƒ«ã®é…åˆ—ã‚’è¡¨ã—ã¦ãŠã‚Šã€å¿…é ˆã§ã™ã€‚  
`>knock-in` ã¨ `>knock-out` ã¯ãã‚Œãã‚Œãƒãƒƒã‚¯ã‚¤ãƒ³ã¨ãƒãƒƒã‚¯ã‚¢ã‚¦ãƒˆã®æƒ³å®šã‚¢ãƒ¬ãƒ«é…åˆ—ã§ã™ã€‚  

> [!IMPORTANT]
> **FASTAé…åˆ—ã®ä¸¡ç«¯ã¯ã€ã‚¢ãƒ³ãƒ—ãƒªã‚³ãƒ³é…åˆ—ã®ä¸¡ç«¯ã¨ä¸€è‡´ã•ã›ã¦ãã ã•ã„ã€‚**   
> ã‚¢ãƒ³ãƒ—ãƒªã‚³ãƒ³ã‚ˆã‚Šã‚‚é•·ã„ã€ã¾ãŸã¯çŸ­ã„å ´åˆã€ãã®å·®åˆ†ã¯Indelã¨ã—ã¦åˆ¤å®šã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™  

## å˜ä¸€ã‚µãƒ³ãƒ—ãƒ«è§£æ

å˜ä¸€ã‚µãƒ³ãƒ—ãƒ«ã®è§£æã‚³ãƒãƒ³ãƒ‰ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚

```bash
DAJIN2 <-c|--control> <-s|--sample> <-a|--allele> <-n|--name> \
  [-g|--genome] [-t|--threads] [-h|--help] [-v|--version]

å¼•æ•°:
  -c, --control             ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã®FASTQ/FASTA/BAMãƒ•ã‚¡ã‚¤ãƒ«ãŒæ ¼ç´ã•ã‚ŒãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒ‘ã‚¹
  -s, --sample              ã‚µãƒ³ãƒ—ãƒ«ã®FASTQ/FASTA/BAMãƒ•ã‚¡ã‚¤ãƒ«ãŒæ ¼ç´ã•ã‚ŒãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒ‘ã‚¹
  -a, --allele              ã‚²ãƒãƒ ç·¨é›†ã«ã‚ˆã£ã¦æƒ³å®šã•ã‚Œã‚‹ã‚¢ãƒ¬ãƒ«ã‚’è¨˜è¼‰ã—ãŸFASTAãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹
  -n, --name (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)     å‡ºåŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®åå‰ [ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: Results]
  -g, --genome (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)   å‚ç…§ã‚²ãƒãƒ ã®ID (e.g hg38, mm39) [ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: '']
  -t, --threads (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)  ä½¿ç”¨ã™ã‚‹ã‚¹ãƒ¬ãƒƒãƒ‰æ•° [ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 1]
  -h, --help                ãƒ˜ãƒ«ãƒ—ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å‡ºåŠ›
  -v, --version             ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®å‡ºåŠ›
```

### å®Ÿè¡Œä¾‹

```bash
# Example datasetã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
curl -LJO https://github.com/akikuno/DAJIN2/raw/main/examples/example_single.tar.gz
tar -xf example_single.tar.gz

# DAJIN2ã®å®Ÿè¡Œï¼ˆå˜ä¸€ã‚µãƒ³ãƒ—ãƒ«è§£æï¼‰
DAJIN2 \
    --control example_single/control \
    --sample example_single/sample \
    --allele example_single/stx2_deletion.fa \
    --name stx2_deletion \
    --genome mm39 \
    --threads 4
```

## è¤‡æ•°ã‚µãƒ³ãƒ—ãƒ«ã®ä¸€æ‹¬å‡¦ç†

`batch`ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã€è¤‡æ•°ã‚µãƒ³ãƒ—ãƒ«ã®åŒæ™‚å‡¦ç†ãŒå¯èƒ½ã§ã™ã€‚  
ã‚µãƒ³ãƒ—ãƒ«æƒ…å ±ã‚’ã¾ã¨ã‚ãŸCSVãƒ•ã‚¡ã‚¤ãƒ«ã¾ãŸã¯Excelãƒ•ã‚¡ã‚¤ãƒ«ãŒå¿…è¦ã§ã™ã€‚  

> [!NOTE]
> ã‚µãƒ³ãƒ—ãƒ«æƒ…å ±ã®ã¾ã¨ã‚æ–¹ã¯ã€[ã“ã¡ã‚‰](https://docs.google.com/presentation/d/e/2PACX-1vQMpqzwI9gtGnmMvqh9UFNxmpKDxcnUg74_TgLmd0FbBrrGQTa7CAQZvFlGDC2vxw/embed?start=false&loop=false&delayms=3000)ã‚’ã”å‚ç…§ãã ã•ã„ã€‚  

> [!TIP]
> **åŒã˜å®Ÿé¨“ã«å±ã™ã‚‹ã‚µãƒ³ãƒ—ãƒ«ã«ã¯ã€`name`åˆ—ã«åŒã˜å€¤ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚**  
> åŒä¸€ã®åå‰ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€å‡¦ç†ãŒä¸¦åˆ—åŒ–ã•ã‚Œã€åŠ¹ç‡ãŒå‘ä¸Šã—ã¾ã™ã€‚  
> ã“ã¡ã‚‰ãŒä¸€ä¾‹ã§ã™ ğŸ‘‰ [batch.csv](https://github.com/akikuno/DAJIN2/blob/main/examples/example_batch/batch.csv)

```bash
DAJIN2 batch <-f|--file> [-t|--threads] [-h]

å¼•æ•°:
  -f, --file                CSVã¾ãŸã¯Excelãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹
  -t, --threads (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)  ä½¿ç”¨ã™ã‚‹ã‚¹ãƒ¬ãƒƒãƒ‰æ•° [ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 1]
  -h, --help                ãƒ˜ãƒ«ãƒ—ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å‡ºåŠ›
```

### å®Ÿè¡Œä¾‹

```bash
# Example datasetã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
curl -LJO https://github.com/akikuno/DAJIN2/raw/main/examples/example_batch.tar.gz
tar -xf example_batch.tar.gz

# DAJIN2ã®å®Ÿè¡Œï¼ˆãƒãƒƒãƒå‡¦ç†ï¼‰
DAJIN2 --file batch.csv --threads 4
```


# ğŸ“ˆ å‡ºåŠ›çµæœ

DAJIN2ã®å‡¦ç†ãŒå®Œäº†ã™ã‚‹ã¨ã€`DAJIN_Results/{NAME}`ã¨ã„ã†ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒä½œã‚‰ã‚Œã¾ã™ã€‚  
ã“ã®`DAJIN_Results/{NAME}`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¯ã€ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå«ã¾ã‚Œã¾ã™ï¼š  

```text
DAJIN_Results/tyr-substitution
â”œâ”€â”€ BAM
â”‚   â”œâ”€â”€ tyr_c230gt_01%
â”‚   â”œâ”€â”€ tyr_c230gt_10%
â”‚   â”œâ”€â”€ tyr_c230gt_50%
â”‚   â””â”€â”€ tyr_control
â”œâ”€â”€ FASTA
â”‚   â”œâ”€â”€ tyr_c230gt_01%
â”‚   â”œâ”€â”€ tyr_c230gt_10%
â”‚   â””â”€â”€ tyr_c230gt_50%
â”œâ”€â”€ HTML
â”‚   â”œâ”€â”€ tyr_c230gt_01%
â”‚   â”œâ”€â”€ tyr_c230gt_10%
â”‚   â””â”€â”€ tyr_c230gt_50%
â”œâ”€â”€ MUTATION_INFO
â”‚   â”œâ”€â”€ tyr_c230gt_01%.csv
â”‚   â”œâ”€â”€ tyr_c230gt_10%.csv
â”‚   â””â”€â”€ tyr_c230gt_50%.csv
â”œâ”€â”€ read_plot.html
â”œâ”€â”€ read_plot.pdf
â””â”€â”€ read_summary.xlsx
```

## 1. BAM

BAMãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¯ã€ã‚¢ãƒ¬ãƒ«ã”ã¨ã«åˆ†é¡ã•ã‚ŒãŸBAMãƒ•ã‚¡ã‚¤ãƒ«ãŒæ ¼ç´ã•ã‚Œã¦ã„ã¾ã™ã€‚  

> [!NOTE]  
> `genome`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§å‚ç…§ã‚²ãƒãƒ ã‚’æŒ‡å®šã™ã‚‹ã¨ã€ãã®å‚ç…§ã‚²ãƒãƒ ã«ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆã•ã‚Œã¾ã™ã€‚  
> æŒ‡å®šãŒãªã„å ´åˆã€å…¥åŠ›ã®FASTAãƒ•ã‚¡ã‚¤ãƒ«ã®controlã‚¢ãƒ¬ãƒ«ã«ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆã•ã‚Œã¾ã™ã€‚

## 2. FASTA ã¨ HTML

FASTAãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¯ã€å„ã‚¢ãƒ¬ãƒ«ã®FASTAãƒ•ã‚¡ã‚¤ãƒ«ãŒä¿å­˜ã•ã‚Œã¾ã™ã€‚  
HTMLãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¯ã€å¤‰ç•°ç®‡æ‰€ãŒè‰²ä»˜ã‘ã•ã‚ŒãŸå„ã‚¢ãƒ¬ãƒ«ã®HTMLãƒ•ã‚¡ã‚¤ãƒ«ãŒä¿å­˜ã•ã‚Œã¾ã™ã€‚  
Tyrç‚¹å¤‰ç•°ï¼ˆç·‘è‰²ï¼‰ã®ä¾‹ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ï¼š


<img src="https://raw.githubusercontent.com/akikuno/logos/refs/heads/main/DAJIN2/tyr-substitution.png" width="75%" />


ã¾ãŸã€DAJIN2ã¯ã‚µãƒ³ãƒ—ãƒ«ã«å«ã¾ã‚Œã‚‹ä»£è¡¨çš„ãªSVã‚¢ãƒ¬ãƒ«(Insertion, Deletion, Inversion)ã‚’æŠ½å‡ºã—ã€SVç®‡æ‰€ã‚’ä¸‹ç·šã§è‰²ä»˜ã‘ã—ã¾ã™ã€‚  
ä»¥ä¸‹ã¯ã€Inversionï¼ˆä¸‹ç·šç´«è‰²ï¼‰ã®ä¸¡ç«¯ã«æ¬ å¤±ï¼ˆæ°´è‰²ï¼‰ãŠã‚ˆã³æŒ¿å…¥ï¼ˆèµ¤è‰²ï¼‰ãŒèªã‚ã‚‰ã‚Œã‚‹ä¾‹ã§ã™ï¼š  

<img src="https://raw.githubusercontent.com/akikuno/logos/refs/heads/main/DAJIN2/cables2-inversion.png" width="75%" />


## 3. MUTATION_INFO

MUTATION_INFOãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¯ã€å„ã‚¢ãƒ¬ãƒ«ã®å¤‰ç•°ç®‡æ‰€ã‚’ç¤ºã™ãƒ†ãƒ¼ãƒ–ãƒ«ãŒä¿å­˜ã•ã‚Œã¾ã™ã€‚  
*Tyr*ç‚¹å¤‰ç•°ã®ä¾‹ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ï¼š
- ç‚¹å¤‰ç•°ã®æŸ“è‰²ä½“ä¸Šã®ä½ç½®ã¨ã€å¤‰ç•°ã®ç¨®é¡ãŒè¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚

<img src="https://user-images.githubusercontent.com/15861316/274519342-a613490d-5dbb-4a27-a2cf-bca0686b30f0.png" width="75%">

## 4. read_summary.xlsx / read_plot.html / read_plot.pdf

read_summary.xlsxã«ã¯ã€å„ã‚¢ãƒ¬ãƒ«ã®ãƒªãƒ¼ãƒ‰æ•°ã¨å­˜åœ¨å‰²åˆãŒè¨˜è¿°ã•ã‚Œã¦ã„ã¾ã™ã€‚  
read_plot.html ãŠã‚ˆã³ read_plot.pdf ã¯ã€resd_summary.xlsxã‚’å¯è¦–åŒ–ã—ãŸã‚‚ã®ã§ã€å„ã‚¢ãƒ¬ãƒ«ã®å‰²åˆã‚’å›³ç¤ºã—ã¦ã„ã¾ã™ã€‚  
å›³ä¸­ã®**Allele type**ã¯ã‚¢ãƒ¬ãƒ«ã®ç¨®é¡ã‚’ã€**Percent of reads**ã¯è©²å½“ã™ã‚‹ãƒªãƒ¼ãƒ‰ã®ã‚¢ãƒ¬ãƒ«å‰²åˆã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚  

**Allele type**ã®ç¨®é¡ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ï¼š

- **Intact**ï¼šå…¥åŠ›ã®FASTAã‚¢ãƒ¬ãƒ«ã¨å®Œå…¨ã«ä¸€è‡´ã™ã‚‹ã‚¢ãƒ¬ãƒ«
- **Indels**ï¼š50å¡©åŸºä»¥å†…ã®ç½®æ›ã€æ¬ å¤±ã€æŒ¿å…¥ã€é€†ä½ã‚’å«ã‚€ã‚¢ãƒ¬ãƒ«
- **SV**ï¼š50å¡©åŸºä»¥ä¸Šã®ç½®æ›ã€æ¬ å¤±ã€æŒ¿å…¥ã€é€†ä½ã‚’å«ã‚€ã‚¢ãƒ¬ãƒ«


<img src="https://user-images.githubusercontent.com/15861316/274521067-4d217251-4c62-4dc9-9c05-7f5377dd3025.png" width="75%">

> [!WARNING]  
> PCRã‚¢ãƒ³ãƒ—ãƒªã‚³ãƒ³ã‚’ç”¨ã„ãŸã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ³ã‚°ã§ã¯ã€å¢—å¹…ãƒã‚¤ã‚¢ã‚¹ã®ãŸã‚ **% of reads**ãŒå®Ÿéš›ã®ã‚¢ãƒ¬ãƒ«ã®å‰²åˆã¨ä¸€è‡´ã—ãªã„ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚  
> ã¨ãã«å¤§å‹æ¬ å¤±ãŒå­˜åœ¨ã™ã‚‹å ´åˆã€æ¬ å¤±ã‚¢ãƒ¬ãƒ«ãŒé¡•è‘—ã«å¢—å¹…ã•ã‚Œã‚‹ã“ã¨ã‹ã‚‰ã€å®Ÿéš›ã®ã‚¢ãƒ¬ãƒ«å‰²åˆã‚’åæ˜ ã—ãªã„å¯èƒ½æ€§ãŒé«˜ã¾ã‚Šã¾ã™ã€‚


# ğŸ“£ ãŠå•ã„åˆã‚ã›

ã”è³ªå•ã‚„ãƒã‚°å ±å‘Šã€ã”æ„è¦‹ãƒ»ã”è¦æœ›ãªã©ã€çš†ã•ã¾ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’ãŠå¾…ã¡ã—ã¦ã„ã¾ã™ã€‚  

ã”å ±å‘Šã¯ã€ä»¥ä¸‹ã®Googleãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰ãŠé¡˜ã„ã„ãŸã—ã¾ã™ï¼š  
ğŸ‘‰ [Googleãƒ•ã‚©ãƒ¼ãƒ ](https://forms.gle/r4YRs1th7NGHfDcS9)

ã¾ãŸã€GitHubã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãŠæŒã¡ã®æ–¹ã¯ã€Issueã‹ã‚‰ã‚‚ã”å ±å‘Šé ‚ã‘ã¾ã™ï¼ˆæ—¥æœ¬èªå¯ï¼‰ï¼š  
ğŸ‘‰ [GitHub Issues](https://github.com/akikuno/DAJIN2/issues/new/choose)  

> [!NOTE]
> ã‚ˆãã‚ã‚‹ã”è³ªå•ã«ã¤ã„ã¦ã¯ã€[ã“ã¡ã‚‰](https://github.com/akikuno/DAJIN2/blob/main/docs/FAQ_JP.md)ã‚’ã”è¦§ãã ã•ã„ã€‚


# ğŸ¤ è¡Œå‹•è¦ç¯„

æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ [Contributor Code of Conductï¼ˆã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚¿ãƒ¼è¡Œå‹•è¦ç¯„ï¼‰](https://github.com/akikuno/DAJIN2/blob/main/docs/CODE_OF_CONDUCT.md)ã«åŸºã¥ã„ã¦å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚  

# ğŸ“„ å‚è€ƒæ–‡çŒ®


[Kuno A, et al. (2022) DAJIN enables multiplex genotyping to simultaneously validate intended and unintended target genome editing outcomes. *PLoS Biology* 20(1): e3001507.](https://doi.org/10.1371/journal.pbio.3001507)
