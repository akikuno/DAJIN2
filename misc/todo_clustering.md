# Clustering

## 課題

Nanoporeシークエンスエラーをどう補正するのか

とくにmismatch率が高い塩基においては補正がうまく聞いていない
- うまくいかない理由は、mismatch率が高い塩基はシークエンスエラーの割合もばらつきも大きく、sample - controlが高く出てしまうケースがあるから。

mismatch率が高い塩基に

## 今までにわかっていること

- 連続する単調な塩基配列には連続した欠失(repetitive dels)が多くなる
- 欠失が認められる塩基の、隣接する塩基にも欠失やシークエンスエラーが起こりがち
- シークエンスエラーが有る塩基の、隣接する塩基にもシークエンスラーが起こりがち （←これは要検討！）


## これまで取り組んだこと

### 不明な塩基部位の補正

- [x] 両端における`N`をmatchとして再分布した
- [x] ControlにおけるKnock-in領域をmatchとして再分布した

### シークエンスエラーの補正

- [ ] 1％以上のシークエンスエラーが認められる塩基（Qscore < 10）はmatchとして再分布した
  - → matchとするよりも単純に無視をする、またはエラープロファイルに則って再分布するという形のほうがバイアスがなくて良さそう

- [] 繰り返す欠失（repetitive dels）をmatchとして再分布した
  - Qscore < 10と同じく、repetitive delsのところに点変異があると、matchとして再分布することでバイアスがかかる
  - → repetitive delsのdelは単純に無視をする、またはエラープロファイルに則って再分布するという形のほうがよさそう

- [x] sampleが持つ変異の割合と、対応するcontrolにおける変異の割合を引き算して、0.5%以下のまれな変異はシークエンスエラーとして無視した

- lowessのブートストラップをして、

## これから取り組みたいこと

- controlもクラスタリングして、controlにもあるクラスタは削除する
- 各塩基位置においてQSCOREの分布を可視化
- 3塩基ごとのエラープロファイルを比較して、χ二乗検定などで有意かどうかを検定する

### controlもクラスタリングして、controlにもあるクラスタは削除する

- なぜかControlはクラスタ数が１となる。。。
  - クラスタに分かれてくれなければ引き算ができない。

### controlとsampleを一緒に混ぜてクラスタリングをし、共通するクラスタは削除する
